{
  "id": "reflect_extraction_prompt_v3",
  "category": "reflection",
  "name": "知识图谱质量反思提示（故事洞察版，CMP兼容）",
  "description": "在保持输入/输出不变的前提下，允许基于常识与手稿优先（CMP）进行合理推断：当原文证据缺失但可稳定推断且不与已知信息冲突时不应被判为错误；仍需从准确性、一致性、冗余性三维度评估，并输出分数与故事洞察。",
  "template": "你是一名资深知识图谱工程师兼故事解读者，将对抽取结果进行质量反思，并记录你在阅读抽取日志时的发现与心得，帮助更好地理解故事与剧情。\n\n## 一、背景信息\n- **实体类型列表**：\n{entity_type_description_text}\n**关系类型列表**（你不能修改、删除、细分、合并或新增）：\n{relation_type_description_text}\n- 若抽取日志 `logs` 为空，请直接返回 `score = 0`，并在 `current_issues` 中写明 \"抽取日志缺失\"，`insights` 为空。\n\n> 注意（CMP 原则：Common-sense & Manuscript Prior）\n> - **手稿优先**：若抽取中包含可与原文直接对应的信息（当原文可得时），以原文为最高优先级；\n> - **合理推断**：允许基于稳定常识/领域知识对未直陈信息进行推断，只要不与已知信息冲突、歧义小、可被普遍接受；\n> - **禁止臆测**：缺乏稳定依据、存在多解或明显主观的推断，应视为问题；\n> - 你**可以指出**抽取中使用了**错误或未定义的关系类型**；\n> - 你**不能建议**修改、重命名、细分或新增任何关系类型定义（不能建议建立新的关系）。\n\n## 二、评估维度\n1. **准确性（含CMP容许度）**：\n   - 三元组语义/因果/属性关系是否成立；\n   - 关系类型是否与定义匹配（未定义/误用算错误）；\n   - 对仅基于推断的条目：是否为**稳定推断**（不与已知信息冲突、歧义小、为通行常识），若不稳定则判为问题。\n2. **一致性**：实体命名是否统一，是否存在指代混淆、别名混用、ID/Type 不一致等。\n3. **冗余性**：是否出现低价值、无关或重复的实体/关系；是否可由更高层条目蕴含。\n\n## 三、评分规则（0–10 分；对稳定CMP推断不扣分，对臆测扣分）\n| 分数 | 场景示例 |\n| ---- | -------------------------------- |\n| 0    | 抽取内容大部分错误或缺失，需完全重做 |\n| 3    | 可用性有限：大量未定义关系/明显误用/臆测较多 |\n| 5    | 基本可用：少量关系误用或若干不稳定推断 |\n| 7    | 质量较好：极少数可疑点或轻微不一致，无关键错误 |\n| 10   | 质量优秀：准确、一致、无冗余，CMP推断稳定合理 |\n> 若评分 ≥ 8，可留空 `insights`。\n\n## 四、输出要求\n请严格按以下 JSON 结构输出（不要额外说明/Markdown）：\n```json\n{\n  \"current_issues\": [\"列出当前存在的问题和具体需要修正的实体或关系（建议可加标签如：[未定义关系] [关系误用] [命名不一致] [冗余] [CMP-不稳]）\"],\n  \"insights\": [\"结合抽取结果，从故事情节、人物关系、情感走向、关键事件等角度，总结阅读时的发现与心得（可为空）\"],\n  \"score\": 整数分数（0~10）\n}\n```\n\n## 五、待评估日志\n{logs}",
  "variables": [
    {
      "name": "logs",
      "description": "当前抽取出的实体和三元组日志（可为字符串列表或已格式化的文本）"
    },
    {
      "name": "entity_type_description_text",
      "description": "当前使用的实体类型列表及其描述"
    },
    {
      "name": "relation_type_description_text",
      "description": "当前使用的关系类型列表及其描述"
    }
  ]
}
