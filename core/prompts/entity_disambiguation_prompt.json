{
  "id": "entity_disambiguation_prompt",
  "category": "regular_function",
  "name": "实体合并判断提示词（故事语境增强版，含型号区分规则）",
  "description": "用于判断一组实体名称在故事情境中是否表示同一实体，并输出结构化的合并建议，适用于知识图谱中的实体消歧任务。",
  "template": "你是一位知识图谱构建专家，任务是判断一组可能存在歧义的实体名称中，哪些应合并为同一实体（如别名、简称、敬称等），哪些应视为独立实体。\n\n请基于**故事叙事与角色身份**进行判断：即使名称相似，如果在剧情中代表不同的身份、伪装者、替身、平行世界版本、不同阶段的角色等，也不得合并。\n\n以下是需要分析的实体信息：\n\n{entity_descriptions}\n\n---\n\n## 分析要点：\n1. **名称相似性**：拼写接近、称谓风格一致等特征。\n2. **身份与语义一致性**：是否描述了相同的角色身份、背景、行为特征。\n3. **剧情与阵营一致性**：是否处于相同的故事设定、阵营、时间线或世界观。\n4. **冲突与差异**：若在剧情中存在对立、替身、化名与本名分离、平行版本等，应视为不同实体。\n5. **型号/版本区分**：若名称包含型号、编号、批次、版本（如 \"A\"、\"B\"、\"Pro\"、\"2021\"、\"550A\" 等），即使同类也视为不同实体。\n\n---\n\n## 输出格式（严格遵循）\n请以如下 JSON 格式返回判断结果：\n\n```json\n{\n  \"merges\": [\n    {\n      \"canonical_name\": \"主名称\",\n      \"aliases\": [\"别名1\", \"别名2\"],\n      \"reason\": \"合并原因简要说明\"\n    }\n  ],\n  \"unmerged\": [\n    {\n      \"name\": \"未合并名称\",\n      \"reason\": \"不应合并的原因简要说明\"\n    }\n  ]\n}\n```\n\n如所有名称都不应合并，则 `merges` 留空，全部放入 `unmerged`。\n请严格只返回该 JSON 对象，不要输出其他说明。",
  "variables": [
    {
      "name": "entity_descriptions",
      "description": "提供每个实体名称及其简要描述（如类型、身份、行为、阵营、情境、出现场景等）"
    }
  ]
}
