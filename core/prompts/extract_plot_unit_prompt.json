{
  "id": "generate_plot_prompt",
  "category": "regular_function",
  "name": "事件链→情节判定与生成（简明稳健版）",
  "description": "基于单一输入文本，判定事件链是否构成情节，并在成立时输出结构化信息；兼容单事件的转折/收束型情节。",
  "template": "你是一位叙事结构分析专家。\n任务：仅基于以下输入判定该事件链是否构成一个情节单元（plot），并在成立时输出结构化情节信息。严禁臆测输入外信息；缺失允许填写“未知”。\n\n【输入】\n{event_chain_info}\n\n【解释段约定】\n若卡片的场次/证据/文本包含“动画演绎/新闻解说/旁白/回忆/梦境/OS（画外音）”等标签，则视为解释段。解释段可以出现，但不能单独构成情节，且全链中数量≤1。\n\n【判定规则（3+1）】\nG（Goal 同一目标）：链内事件围绕同一计划/任务/冲突（可从 名称/摘要/动作/结果/证据 抽取统一的主题词或标签）。\nO（Order 顺序可解释）：按给定顺序能讲通；若含解释段，允许非线性，但不得多于 1 条，且需紧贴并支撑相邻真实事件。\nC（Continuity 连续性）：相邻事件在“参与者”或“地点”至少一项连续。\n+1（Outcome 结果/转折）：链内至少 1 个事件出现明确结果或转折。\n→ 同时满足 G、O、C 且具备 Outcome，判定为情节；否则不成立。\n单事件特例：必须同时具备“可辨目标/动机”和“明确结果/转折”，否则不成立。\n\n【输出格式（严格遵循）】\n请严格输出以下 JSON 对象，不要输出任何多余解释或前后缀：\n\n{{\n  \"is_plot\": \"true 或 false\",\n  \"reason\": \"简要说明判断理由，控制在3-5句话内\",\n  \"plot_info\": {{\n    \"title\": \"为该情节生成一个独特且易区分的标题（不超过20字），必须结合事件链中的关键信息，例如地点、关键人物、时间节点或结果，不要只用泛化主题词。保证同主题但不同事件链的标题也能明显区分。\",\n    \"summary\": \"若构成情节，用100-200字完整描述该情节的主要内容，需涵盖关键人物、地点、冲突与结局，避免与其他情节链的描述混淆。\",\n    \"main_characters\": [\"角色A\", \"角色B\"],\n    \"locations\": [\"地点A\", \"地点B\"],\n    \"time\": \"该情节发生的大致时间范围描述，如‘爆炸后一小时内’、‘任务开始前夕’等\",\n    \"theme\": \"情节主题，如‘牺牲’、‘背叛’、‘团聚’\",\n    \"goal\": \"主要任务或目标，如‘阻止危机’、‘营救人质’\",\n    \"conflict\": \"主要冲突或阻力，如‘资源不足’、‘敌方阻拦’\",\n    \"resolution\": \"情节的结果或结局，如‘成功’、‘失败’、‘牺牲’\"\n  }}\n}}\n\n- 若 is_plot=false，则 plot_info 必须为 {{}}。\n- 仅使用输入中的信息进行填充；数组元素为字符串。",
  "variables": [
    {
      "name": "event_chain_info",
      "description": "单个文本块，先给出事件链头（如：事件链：ent_a->ent_b->...），随后逐条给出各事件的 event_card（至少含：名称/摘要/地点/参与者/动作/结果/证据；可选：time/scene_name/scene_id/plan_tags/mode）"
    }
  ]
}
